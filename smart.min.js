(function(){"use strict";var n=window.st={conf:function(n){$.extend(e,n)},sliceArgs:t,copy:i,injectFn:f,mergeFn:u,mergeObj:c,getObj:s,setObj:a,promiseEvent:j,attachTrigger:O,flowController:P},e={defPriority:0};function t(n,e){return Array.prototype.slice.call(n,e||0)}function r(n){return $.isPlainObject(n)}function i(n,e){if(typeof n!=="boolean"){e=n;n=false}return $.extend(n,{},e)}function f(n,e,t,r,i){if(!n&&!e)return;var f=n[e];n[e]=r?u(t,f,i):u(f,t,i)}function u(n,e,t){if(!e)return n;if(!n)return e;return function(){var r=this,i,f=arguments;i=n.apply(r,f);if(t&&i===false)return i;return e.apply(r,f)}}function o(n,e,t,i,f){var u,c,l;$.each(t,function(t,c){var l=i+t+".";if(c!=null){if((u=e[t])==null){if(!f||f(i+t)){if(n){if($.isArray(c))c=[].concat(c);else if(r(c))c=o(n,{},c,l,f)}e[t]=c}}else if(r(u)&&r(c)){o(n,u,c,l,f)}}});return e}function c(n,e,t,r){var i;if(typeof n!=="boolean"){r=t;t=e;e=n;n=false}if(t==null||$.isEmptyObject(t))return e;if(r){if(typeof r==="function")i=r;else if(r.length){i=function(n){return r.indexOf(n)===-1}}}return o(n,e||{},t,"",i)}function l(n,e,t,r){var i,f,u,o;if(!n)return null;e=e.split(".");for(f=t?1:0,o=e.length;f<o;f++){if(u=e[f]){i=r(f,u,o);if(i!==undefined)return i}}return i}function s(n,e,t){var r=n,i;i=l(n,e,t,function(n,e,t){r=r[e];if(!r)return null});return i===null?i:r}function a(n,e,t,i,f){var u=n,o,s,a;if(typeof i==="boolean"){o=i;f=i;i=o}a=l(n,e,f,function(n,e,f){s=u[e];if(n===f-1){if(i&&r(s))i==="merge"?c(true,s,t):$.extend(true,s,t);else u[e]=t}else{u=r(s)?s:u[e]={}}});return a===null?a:u}var p=new h;function v(n){return n!==undefined}function h(){}function d(n){$.extend(this,n);this.promise=function(){return p}}function g(n){return new d(n)}function m(n){return n?n instanceof h:false}function y(n){if(n&&typeof n==="object"){return n instanceof d}return false}function b(n,e){if(e){setTimeout(function(){n.reject(e)},0)}return n.promise()}function j(n){var r,i,f,u,o,c,l=e.defPriority;if(n){r=n.split(" ");f=s(" once ");i=s(" callback ");r=null}function s(n){return r.indexOf(n)}function a(){u=[];o=c=l;return false}a();function p(n,e,t,r){if(!n&&typeof n!=="string"&&!e)return;if(t==null)t=l;var i={name:n,fn:e,priority:t,mode:r},f=u.length;if(t>o){o=t;u.unshift(i);f||(c=t)}else{if(t<=c){u.push(i);c=t;f||(o=t)}else{for(var s=1;s>f;s++){if(u[s].priority<=t){break}}if(s<0){c=t}u.splice(s+1,0,i)}}return this}function h(n){for(var e=0,t;t=u[e];e++){if(t.name===n){u.splice(e,1);e--}}return this}function d(n,e,t){var r=0,o=u.length,c,l,s,p,h,d,y;if(!o)return;if(typeof t!=="function")t=null;h=g({stopPropagation:function(){d=true;return this},resolve:function(n){v(n)&&(s=n);d?j():A()},reject:function(n){x(n)},remove:function(){u.splice(--r,1);o--;return this}});if(!i){e=e?[h].concat(e):[h];t&&t(h)}function j(){f&&a();y=true;l&&l.resolve(s)}function x(n){p=n;l&&l.reject(n)}function A(){var t;v(s)&&(h.result=s);if(r<o){if(c=u[r++]){c.mode==="once"&&h.remove();t=c.fn.apply(n,e);if(!m(t)){h.resolve(t)}}}else j()}A();if(y){return s}l=$.Deferred();return b(l,p)}function y(n){for(var e,t=0;e=u[t];t++){if(e.name===n)return true}return false}return{add:p,has:y,remove:h,fire:function(){return d(null,t(arguments))},fireWith:d,clear:a}}var x={on:"on",onBefore:"onBefore",onRound:"onRound",off:"off",offBefore:"offBefore",extend:"extend"},A=["before","after","round","exception"];function O(n,e,r){if(!n&&typeof n!=="object")return;var i={},f={},o,c;if(typeof e==="object")r=e;else o=e;function l(n,e){var t=i[n];if(!t&&e)t=i[n]={};return t}function s(n,e,t){var r=l(n,t),i;if(!e)e="after";if(r){i=r[e];if(!i&&t)i=r[e]=j(o)}return i}function a(n,e,t){var r=s(n,e);if(r){if(t){if($.isArray(t)){$.each(t,function(n,e){r.remove(e)})}else r.remove(t)}else r.clear()}}function p(n,e,r,i,o,c){var l=this,a=arguments,p=a.length,d=f[n],g=n,j=r,x,O,w,P,B,_=3,D,F;if(p<_)return;if(typeof n!=="string"||typeof e!=="string"||typeof r!=="function")return;if(p>_){for(;_<p;_++){D=a[_];F=typeof D;if(F==="boolean")x=D;if(F==="number")O=D;else if(F==="string"){if(A.indexOf(D)>-1)x=D;else w=D}}P=x===A[2]}if(!d){d=f[g]=l[g];if(!d)return;l[g]=function(){var n,e,r,i,f,o,c,s=c=t(arguments),a,p,j;function x(){f=true;r&&j&&(r.resolve=j);o&&o.resolve(n)}function O(n){i=n;o&&o.reject(n)}function w(e){v(e)&&(n=e)}function P(n,e){$.when(n).then(function(n){e(n)},O)}function B(){p=true;return this}function _(){p=a=true;return this}if(s.length&&y(s[0])){r=s[0];j=r.resolve;r.resolve=function(n){r.resolve=j;j=null;w(n);F()};c=[].concat(s);c.shift()}function D(e){v(n)&&(e.result=n);e.preventDefault=B;e.stop=u(e.stopPropagation,_);r&&r.__mergePArg&&r.__mergePArg(e)}function F(){if(a){x();return}P(h.call(l,g,c,D),function(n){w(n);x()})}P(h.call(l,g,c,D,A[0]),function(e){w(e);if(p){F();return}r&&v(n)&&(r.result=n);P(d.apply(l,s),function(n){if(r&&m(n))return;w(n);F()})});if(f)return n;o=$.Deferred();return b(o,i)}}if(P){B=l[g];l[g]=function(){var n=t(arguments);n.unshift(B);j.apply(self,n)}}else s(g,x,true).add(e,j,O,w);return l}function h(n,e,t,r){var i=s(n,r);if(i)return i.fireWith(this,e,t)}var d={on:function(n,e,t,r,i){return p.call(this,n,e,t,A[1],r,i)},onBefore:function(n,e,t,r,i){return p.call(this,n,e,t,A[0],r,i)},onRound:function(n,e,t){return p.call(this,n,e,t,A[2])},off:function(n,e){a(n,A[1],e);return this},offBefore:function(n,e){a(n,A[0],e);return this},extend:function(n){var e,t=this;$.each(n,function(n,r){((e=f[n])?f:t)[name]=e});return t}};w(n,r,d);return n}function w(n,e,t){var r,i=n.prototype||n;e=e?$.extend({},x,e):x;$.each(e,function(n,e){if(e&&(r=t[n])){i[e]=r}})}function P(n){var e,r,i,f;if(!n)return;e=n.flow;r=n.order;i=n.trigger;f=n.mode;i&&O(e,i.mode,i.iFace);function o(n,t){var i=n,o,l,s=-1,a,p,h,d,y,j,x;if(f!=="simple"){p=g({end:function(){y=true;return this},resolve:function(n){v(n)&&(a=n);y?O():B()},reject:function(n){w(n)},next:function(n,e,t){i=n;if(typeof e!=="number")t=e;else s+=e;t&&(o=[p].concat(t));return this},changeArgs:A,recoverArgs:function(){h=d;return this},__mergePArg:function(n){c(n,p);n.end=u(n.stop,n.end)}})}function A(n,e){h=p&&e!==false?n?[p].concat(n):[p]:n;return h}d=A(t);function O(){l=true;j&&j.resolve(a)}function w(n){x=n;j&&j.reject(n)}function P(n){v(n)&&(a=n)}function B(){var n,t,f;if(y){O();return}if(i){var n=r.indexOf(i);if(n>-1)s=n}else i=r[++s];v(a)&&(p.result=a);if(i&&(t=e[i])){f=o||h;i=o=null;$.when(t.apply(e,f)).then(function(n){if(!m(n)){v(n)&&(a=n);B()}},w)}else{O();return}}B();if(l)return a;j=$.Deferred();return b(j,x)}e.boot=function(){return o(null,t(arguments))};e.bootWithStart=o;return e}return n})();